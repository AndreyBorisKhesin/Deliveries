\input{header}
\physics
\begin{document}
\papertitle{Optimizing the Distribution of Goods}
\paperauth{C}{Cheng}{University of Toronto}
\paperauth{A}{Khesin}{University of Toronto}
\paperdate{April 30th, 2018}
\begin{paperabs}
In this paper, we analyze the most efficient way to plan delivery routes for trucks delivering heaters and conditioners from plants, to warehouses, and then to stores.
We find that an efficient way to do this is to not plan the schedule in advance but instead to order trucks from the rental agency as needed, for a 20\% surcharge.
The resulting expected profit was found to be 17 440 000 Euros with a standard deviation of 70 000 Euros.
\end{paperabs}
\begin{paper}
\papersec{Introduction}

The presented problem asks what is the best way to optimize the distribution of
goods, given certain constraints, without knowing where they will be needed and
when.
For this task, we designed and tested several algorithms, by implementing a
program to check how the algorithms perform, given a random set of customers.
The customers were in turn generated by the program from the provided
spreadsheet of historical data with the corresponding random noise.

In solving this problem several important assumptions were made, which are
listed below.
\begin{enumerate}
\item
Trucks, when starting their route from the warehouse, are only allowed to
deliver items to a shop, pick up items at a plant, or both in that order, after
which they must return to the warehouse they departed from.
Thus, going directly from one shop to another is not allowed.
\item
The number of customers for a given shop, for a given product is determined
as follows.
First the total number of customers that visited that shop looking for that
product in a given month was calculated.
This value was modified by a randomly chosen coefficient between 0.9 and 1.1.
Then, the resulting value was rounded and that number of customers was randomly
distributed among the business days of that month.
\item
Products cost nothing to produce, seeing as the price was
not mentioned anywhere in the problem statement.
This could be interpreted as the fact that the factory workers have fixed
contracts, so that their wages will be expenses regardless of the amount
produced.
Additionally, there is no limit to the amount of products that can be produced
in a day.
\item
After the sales for a given day had ended, an assesment of the current stock
could be made, and additional trucks ordered for that same night at the extra
rate.
\item
If a customer walks into a store and sees that the item they want is not
available, they are told to come by the next day, and there is a 20\%
probability that they do not come back, and an 80\% probability that they do.
\end{enumerate}

In the above list, the second rule has the random 10\% fluctuation applied to
the total number of customers in a month, as the daily number of customers is
typically so small that any value within 10\% will just round to the average,
erasing any variance in the number of customers from day to day.

\papersec{Method}

The key to our approach was noticing the large disparity in cost between the
prices of a heater and an air conditioner, compared to the expenses of driving
delivery trucks, even when considered with a 20\% penalty.
In fact, the price of a single heater is enough to cover even the longest of
delivery routes to a single shop.
This means that even missing out on a single sale is more costly than paying 
extra to make sure that a shop is fully stocked.

The result is that it is better to pay a 20\% fee on the relatively small cost
of deliveries to ensure that there will be enough of each product for the coming
customers.
Thus, the only part of the schedule that is ordered in advance is a list of 149 truck
routes, to fill the warehouses, fill the stores, then refill the warehouses.
This is done as described below.

To fill a warehouse, trucks always drive to the plant whose number matches that
of the warehouse.
Although plant $P_2$ is equidistant from warehouses $W_1$ and $W_2$, distributing the production
this way is sensible.
Shops $S_1$, $S_3$, $S_4$, $S_6$, $S_7$, $S_{11}$, $S_{12}$, $S_{14}$, $S_{17}$, $S_{18}$ are refilled from warehouse $W_1$, while shops $S_2$, $S_5$, $S_8$, $S_9$, $S_{10}$, $S_{13}$, $S_{15}$, $S_{16}$, $S_{19}$, $S_{20}$ are refilled from warehouse $W_2$.

After the first day, all trucks are purchased the day of at a 20\% fee.
Every day, the expected number of customers for each shop, for each product is determined as the average of 
the mean number of daily customers that came to that shop in 2015 and the mean number of customers that have come to the
shop so far this month.
(If it is currently the first day of the month, the expected number of customers is just the mean number of daily customers that came to that shop in 2015.)
A truck is dispatched to refill the shop if the shop's stock falls below 1.2 times the expected number of customers.
The coefficient was chosen as 1.2 as it gave the best average profit in our simulations.
If the value were lower, then sales would be lost.
If the value were higher, then too much money would be spent by unnecessarily restocking the shops.

Meanwhile, a warehouse is refilled if it has fewer than 600 heaters or 625 air conditioners, e.g. it can fit one more truckload.
The route to restock the warehouse is appended to one of the routes to restock the shops by minimizing total distance.
Thus, if warehouse $W_1$ needs to be refilled, it prioritizes appending the route to the first shop that is being refilled in the following list: $S_6$, $S_7$, $S_{11}$, $S_1$, $S_{12}$, $S_3$, $S_{18}$, $S_{14}$, $S_4$, $S_{17}$.
For warehouse $W_2$, the order is $S_8$, $S_{15}$, $S_{19}$, $S_{16}$, $S_5$, $S_9$, $S_{13}$, $S_{20}$, $S_{10}$, $S_2$.

To ensure that the plants always have sufficient products, each produces 650 of each product, and then produces up to that amount whenever any is taken out for the purposes of refilling a warehouse.

This fully describes the algorithm that was used.

\papersec{Data}

Data goes here

\papersec{Analysis}

The provided algorithm is too complex to accurately compute a probability law for without a Monte Carlo simulation.
Additionally, if the customer amounts and distributions were taken at their average values, then the resulting profits would be overreported as expenses increase with large fluctuations in the number of customers.

All values that follow are in Euros, and are rounded to the nearest Euro.
After simulating 1000 possible equally likely scenarios by customer distribution, the average revenue was determined to be \SI{17487888}{} with a standard deviation of \SI{67751}{}, giving an expected revenue of $(17.49\pm.07)M$.
The average expenses were determined to be \SI{45068}{} with a standard deviation of \SI{200}{}, giving expected expenses of $(45.1\pm.2)K$.
Meanwhile, the average profit was determined to be \SI{17442820}{} with a standard deviation of \SI{67603}{}, giving an expected profit of $(17.44\pm.07)M$.

Thus, the expected profit is 17 442 820 Euros, with a standard deviation of 67 603 Euros.
Considering the significant digits are random noise, we can confidently state that the expected profit will be 17 440 000 Euros, with a standard deviation of 70 000 Euros.

\papersec{Conclusion}

As we have shown, without full foresight of when the customers will arive, the most efficient way we could determine of delivering the heaters and air conditioners was using current information to make efficient decisions about how to plan delivery routes.
This resulted in an expected profit of 17 440 000 Euros, with a standard deviation of 70 000 Euros.

It is worth noting that a single standard deviation in the revenue and the profit is noticably more than all of the combined expenses.
This disparity only goes to show that it is worth paying a 20\% in the name of maximizing revenues, as the latter will be significantly higher than the expenses.
In fact, even a very inefficient delivary schedule that ensures no customer is ever disappointed will have total expenses in the hundreds of thousands of Euros, which is still a tiny fraction of the proft.
Overall, the year to year fluctuations of customers by as much as 10\% will make more of an impact on the company's profit than their delivery schedule will.

\papersec{Code}

Below we include the code used to compute this result.
\end{paper}

\lstinputlisting[language=python]{deliveries.py}

\end{document}
